

<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
      components/users/Login.js - ODU ALMP Docs
  </title>

  <link href="https://www.braintreepayments.com/images/favicon-ccda0b14.png" rel="icon" type="image/png">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

  <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
  <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
  

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
  <script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
  

  <!-- start Mixpanel -->
  <script type="text/javascript">(function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("1919205b2da72e4da3b9b6639b444d59");</script>
  <!-- end Mixpanel -->
</head>

<body>
  <svg style="display: none;">
    <defs>
      <symbol id="linkIcon" fill="#706d77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
          <path d="M0 0h24v24H0z" fill="none"/>
          <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>
      </symbol>
    </defs>
  </svg>

  <input type="checkbox" id="nav-trigger" class="nav-trigger" />
  <label for="nav-trigger" class="navicon-button x">
    <div class="navicon"></div>
  </label>

  <label for="nav-trigger" class="overlay"></label>

  <div class="top-nav-wrapper">
    <ul>
      <li >
        <a href="index.html">
          
            <svg fill="#6D6D6D" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
              <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
              <path d="M0 0h24v24H0z" fill="none"/>
            </svg>
          
          
        </a>
      </li>

      
      <li>
        <div class="search-wrapper">
          <svg fill="#6D6D6D" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
            <path d="M0 0h24v24H0z" fill="none"/>

          </svg>
          <input type="text" placeholder="Search" class="search-input">
        </div>
      </li>
      

    </ul>
  </div>

  <nav>
    <h3 class="reference-title">
      Asynchronous Learning Management System @ ODU-EMSE
    </h3>

    

    <h3>Classes</h3><ul><li id="App-nav"><a href="App.html">App</a></li><li id="Course-nav"><a href="Course.html">Course</a></li><li id="Dashboard-nav"><a href="Dashboard.html">Dashboard</a><ul class='methods'><li data-type="method" id="Dashboard-Panel-nav"><a href="Dashboard.html#.Panel">Panel</a></li><li data-type="method" id="Dashboard-RenderLineChart-nav"><a href="Dashboard.html#.RenderLineChart">RenderLineChart</a></li></ul></li><li id="Login-nav"><a href="Login.html">Login</a><ul class='methods'><li data-type="method" id="Login-change-nav"><a href="Login.html#.change">change</a></li><li data-type="method" id="Login-onLogin-nav"><a href="Login.html#.onLogin">onLogin</a></li></ul></li><li id="PlanOfStudy-nav"><a href="PlanOfStudy.html">PlanOfStudy</a><ul class='methods'><li data-type="method" id="PlanOfStudy-getPlan-nav"><a href="PlanOfStudy.html#.getPlan">getPlan</a></li><li data-type="method" id="PlanOfStudy-loader-nav"><a href="PlanOfStudy.html#.loader">loader</a></li></ul></li><li id="Profile-nav"><a href="Profile.html">Profile</a><ul class='methods'><li data-type="method" id="Profile-deleteUser-nav"><a href="Profile.html#~deleteUser">deleteUser</a></li><li data-type="method" id="Profile-getUser-nav"><a href="Profile.html#~getUser">getUser</a></li><li data-type="method" id="Profile-handleInstructorProfileChange-nav"><a href="Profile.html#~handleInstructorProfileChange">handleInstructorProfileChange</a></li><li data-type="method" id="Profile-toggleInstructor-nav"><a href="Profile.html#~toggleInstructor">toggleInstructor</a></li><li data-type="method" id="Profile-updateUser-nav"><a href="Profile.html#~updateUser">updateUser</a></li></ul></li><li id="Protector-nav"><a href="Protector.html">Protector</a></li><li id="Register-nav"><a href="Register.html">Register</a><ul class='methods'><li data-type="method" id="Register-change-nav"><a href="Register.html#.change">change</a></li><li data-type="method" id="Register-nextStep-nav"><a href="Register.html#.nextStep">nextStep</a></li><li data-type="method" id="Register-previousStep-nav"><a href="Register.html#.previousStep">previousStep</a></li></ul></li><li id="UserInfo-nav"><a href="UserInfo.html">UserInfo</a><ul class='methods'><li data-type="method" id="UserInfo-next-nav"><a href="UserInfo.html#~next">next</a></li></ul></li><li id="UserVerify-nav"><a href="UserVerify.html">UserVerify</a></li></ul><h3>Modules</h3><ul><li id="GetPlanByStudentID-nav"><a href="module-GetPlanByStudentID.html">GetPlanByStudentID</a><ul class='methods'><li data-type="method" id="GetPlanByStudentID-getPlan-nav"><a href="module-GetPlanByStudentID.html#~getPlan">getPlan</a></li></ul></li><li id="InstructorProfileContext-nav"><a href="module-InstructorProfileContext.html">InstructorProfileContext</a><ul class='methods'><li data-type="method" id="InstructorProfileContext-contextReducer-nav"><a href="module-InstructorProfileContext.html#~contextReducer">contextReducer</a></li><li data-type="method" id="InstructorProfileContext-InstructorProvider-nav"><a href="module-InstructorProfileContext.html#~InstructorProvider">InstructorProvider</a></li><li data-type="method" id="InstructorProfileContext-useInstructorContext-nav"><a href="module-InstructorProfileContext.html#~useInstructorContext">useInstructorContext</a></li></ul></li></ul><h3 id="global-nav">Global</h3><ul><li><a href="global.html#abandonModule">abandonModule</a></li><li><a href="global.html#calculateRating">calculateRating</a></li><li><a href="global.html#checkTaken">checkTaken</a></li><li><a href="global.html#convert">convert</a></li><li><a href="global.html#decoder">decoder</a></li><li><a href="global.html#getModule">getModule</a></li><li><a href="global.html#getRandomNum">getRandomNum</a></li><li><a href="global.html#getToken">getToken</a></li><li><a href="global.html#isAuthenticated">isAuthenticated</a></li><li><a href="global.html#loader">loader</a></li><li><a href="global.html#profileCheck">profileCheck</a></li><li><a href="global.html#progress">progress</a></li><li><a href="global.html#rating">rating</a></li><li><a href="global.html#refreshPage">refreshPage</a></li><li><a href="global.html#removeToken">removeToken</a></li><li><a href="global.html#round_to_precision">round_to_precision</a></li></ul>
  </nav>

  <div id="main">
    
      <h1 class="page-title">
        components/users/Login.js
      </h1>
    

    
      

<section>
  <article>
    <pre class="prettyprint source linenums"><code>import React, { useState } from 'react'
import axios from 'axios'
import { ToastContainer, toast } from 'react-toastify'
import { getToken, refreshPage, loader } from '../helpers'
import { Link } from 'react-router-dom'

/**
 * @component
 * @name Login
 * @description This component is used to render the login page.
 * @param {React.FC&lt;Props>} props - Simple props object that we use to redirect the user after they are successfully authenticated. The members of this object come from `react-router-dom`'s `&lt;Route>` component.
 * @returns {React.ReactHTMLElement} The rendered HTML element that wraps this component within the page.
 */
const Login = (props) => {
	/**
	 * @member
	 * @name LoginComponentState
	 * @memberof Login
	 * @type {React.ComponentState}
	 * @property {String | null} [email=null] The current state of the email form field.
	 * @property {String | null} [password=null] The current state of the password form field.
	 * @property {Boolean} [loading=false] The current state of the loading indicator based on fetching and requests being sent.
	 * @description This is the states of the component. These properties come from the return of the initialization of the specific `useState`, which returns a tuple of the current state and a function that allows us to update the state. Initial values are set on load.
	 */
	const [email, setEmail] = useState(null)
	const [password, setPassword] = useState(null)
	const [loading, setLoading] = useState(false)

	/**
	 *
	 * @param {React.FormEvent} e - The event that is triggered when the user changes the form data.
	 * @function
	 * @memberof Login
	 * @description This function is used to handle all the changes that are done to either the email or password fields in the form.
	 * @todo Simplify this function by switch the state of the email and password fields to a single user state with email and password as a key.
	 */
	const change = (e) => {
		if (e.target.name === 'email') {
			setEmail(e.target.value)
		}
		if (e.target.name === 'password') {
			setPassword(e.target.value)
		}
	}

	/**
	 * @name onLogin
	 * @description This function takes in an html event element to prevent the default browser behavior. It then creates the GraphQL query to login the user, and asks for the token back as a response. If no errors are present in the returned data, the token is saved in local storage and the user is redirected to the home page after a success message. If errors are present, an error message is displayed in a small notification toast.
	 * @function
	 * @memberof Login
	 * @param {React.FormEvent} e - The event that is triggered when the user submits the form.
	 */
	const onLogin = (e) => {
		e.preventDefault()

		setLoading(true)

		let data = {
			query: `query{
				login (input: {email: "${email}", password: "${password}"}){
                    token
				}
			}`,
		}

		if (email.length > 0 &amp;&amp; password.length > 0) {
			axios
				.post(`${process.env.REACT_APP_API}/graphql`, data)
				.then((res) => {
					if (res.data.errors) {
						setLoading(false)
						return toast.error(res.data.errors[0].message, {
							position: toast.POSITION.TOP_RIGHT,
						})
					} else {
						const { token } = res.data.data.login
						setLoading(false)
						localStorage.setItem('JWT', token)
						// refreshPage()
						return props.history.push('/dashboard')
					}
				})
				.catch((err) => {
					console.error('onLogin() error: ', err)
					setLoading(false)
				})
		} else {
			setLoading(false)
			return toast.error('Please fill out all fields.', {
				position: toast.POSITION.TOP_RIGHT,
			})
		}
	}

	if (loading) {
		return loader()
	} else {
		if (getToken() !== `Bearer ${null}`) {
			props.history.push('/portal')
			return null
		} else {
			return (
				&lt;div className="lg:w-1/2 md:w-2/3 sm:mx-4 md:mx-auto mt-4 bg-gray-100 py-5 px-3 rounded shadow border border-gray">
					&lt;h1 className="text-3xl">Login&lt;/h1>
					&lt;ToastContainer />
					&lt;form className="w-full my-1">
						&lt;div className="my-3 w-full">
							&lt;label
								htmlFor="email"
								className="text-gray-400 font-xs"
							>
								ODU affiliated email
							&lt;/label>
							&lt;input
								type="email"
								className="py-2 px-3 w-full border border-gray rounded "
								placeholder="example@odu.edu"
								name="email"
								value={email}
								onChange={(e) => change(e)}
								required
							/>
						&lt;/div>
						&lt;div className="my-3 w-full">
							&lt;label
								htmlFor="password"
								className="text-gray-400 font-xs"
							>
								Password
							&lt;/label>
							&lt;input
								type="password"
								className="py-2 px-3 w-full border border-gray rounded"
								placeholder="Password"
								name="password"
								onChange={(e) => change(e)}
								required
							/>
						&lt;/div>
						&lt;button
							className="text-gray-100 rounded border-2 border-blue-400 py-2 px-4 bg-blue-400 w-1/2 mx-auto block transition-all hover:bg-transparent hover:text-gray-800"
							type="submit"
							onClick={(e) => onLogin(e)}
						>
							Log in
						&lt;/button>
						&lt;div className="w-full text-center">
							&lt;div className="mt-4 block font-sm text-gray-800 font-weight-light">
								or{' '}
								&lt;Link to="/users/forgot" className="">
									&lt;span className="hover:underline hover:text-gray-800 text-blue-800">
										Reset your password
									&lt;/span>
								&lt;/Link>
							&lt;/div>
							&lt;div className="mt-4 block font-sm text-gray-800 font-weight-light">
								Don't have an account?{' '}
								&lt;Link to="/users/register">
									&lt;span className="hover:underline hover:text-gray-800 text-blue-800 font-bold">
										Sign up
									&lt;/span>
								&lt;/Link>
							&lt;/div>
						&lt;/div>
					&lt;/form>
				&lt;/div>
			)
		}
	}
}

export default Login
</code></pre>
  </article>
</section>

    


  </div>

  <br class="clear">

  <footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.10</a> <br/>
    Theme by <a href="https://github.com/braintree/jsdoc-template">Braintree</a> <br/>
  </footer>

  <script src="scripts/linenumber.js"></script>
  <script src="scripts/pagelocation.js"></script>

  
  {# <script>
    $(function () {
      window.docsearch({
        apiKey: '',
        indexName: 'braintree',
        inputSelector: '.search-input',
        debug: false, // Set debug to true if you want to inspect the dropdown
        algoliaOptions: {
          hitsPerPage: 7
        }
      });
    });
  </script> #}
  

</body>
</html>
